<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Daftar Karyawan — API Static</title>
<style>
  /* macOS Monterey-inspired light theme (clean, soft shadows, rounded cards) */
  :root{
    --bg:#f5f7fa;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#0b84ff;
    --glass: rgba(255,255,255,0.7);
  }
  body{
    margin:0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg,var(--bg),#ffffff);
    color:#0f172a;
  }
  header{
    padding:22px;
    backdrop-filter: blur(6px);
    box-shadow: 0 6px 18px rgba(15,23,42,0.06);
  }
  .container{
    max-width:1100px;
    margin:18px auto;
    padding:18px;
  }
  .card{
    background:var(--card);
    border-radius:12px;
    padding:16px;
    box-shadow: 0 8px 24px rgba(11,20,40,0.06);
  }
  h1{ margin:0 0 8px 0; font-size:20px; }
  p.lead{ margin:0 0 14px 0; color:var(--muted); }
  .controls{ display:flex; gap:12px; align-items:center; margin-bottom:12px; }
  input[type="search"]{
    flex:1;
    padding:10px 12px;
    border-radius:10px;
    border:1px solid #e6e9ef;
    outline:none;
    font-size:14px;
  }
  select{
    padding:10px 12px;
    border-radius:10px;
    border:1px solid #e6e9ef;
    background:var(--glass);
    font-size:14px;
  }
  table{
    width:100%;
    border-collapse:collapse;
    margin-top:12px;
    font-size:14px;
  }
  th, td{
    text-align:left;
    padding:10px 12px;
    border-bottom:1px solid #f0f2f5;
  }
  th{ color:var(--muted); font-weight:600; font-size:13px; }
  tr:hover td{ background: linear-gradient(90deg, rgba(11,132,255,0.04), rgba(255,255,255,0)); }
  .pagination{ display:flex; gap:8px; margin-top:12px; align-items:center; }
  .btn{
    padding:8px 10px;
    border-radius:8px;
    border:1px solid #e6e9ef;
    background:white;
    cursor:pointer;
  }
  .small{ font-size:13px; color:var(--muted); }
</style>
</head>
<body>
<header>
  <div class="container">
    <h1>Daftar Karyawan (Static API)</h1>
    <p class="lead">Data dummy 400 karyawan — ambil dari <code>data.json</code>. Tema: light (macOS Monterey vibe).</p>
  </div>
</header>

<main class="container">
  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div style="flex:1;">
        <div class="controls">
          <input id="search" type="search" placeholder="Cari nama, departemen, unit kerja..." />
          <select id="filter-dept">
            <option value="">Semua Departemen</option>
          </select>
          <select id="per-page">
            <option value="10">10 / halaman</option>
            <option value="25">25 / halaman</option>
            <option value="50">50 / halaman</option>
            <option value="100">100 / halaman</option>
          </select>
        </div>
      </div>
      <div style="margin-left:12px;">
        <div class="small">Total: <span id="total">0</span> karyawan</div>
      </div>
    </div>

    <div style="overflow:auto;">
      <table id="tbl">
        <thead>
          <tr>
            <th>#</th><th>Nama</th><th>Departemen</th><th>Unit Kerja</th><th>Jabatan</th><th>Tanggal Masuk</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="pagination" id="pager"></div>
  </div>
</main>

<script>
const apiUrl = "./data.json";
let data = [];
let filtered = [];
let page = 1;
let perPage = 10;

async function loadData(){
  try{
    const res = await fetch(apiUrl);
    data = await res.json();
    document.getElementById('total').textContent = data.length;
    populateDeptFilter();
    applyFilters();
  }catch(e){
    console.error(e);
    alert("Gagal memuat data.json — pastikan file ada di repo.");
  }
}

function populateDeptFilter(){
  const sel = document.getElementById('filter-dept');
  const depts = Array.from(new Set(data.map(d=>d.departemen))).sort();
  depts.forEach(d=>{
    const o = document.createElement('option');
    o.value = d; o.textContent = d;
    sel.appendChild(o);
  });
}

function applyFilters(){
  const q = document.getElementById('search').value.trim().toLowerCase();
  const dept = document.getElementById('filter-dept').value;
  perPage = parseInt(document.getElementById('per-page').value,10);
  filtered = data.filter(d=>{
    const hay = (d.nama + " " + d.departemen + " " + d.unit_kerja).toLowerCase();
    if(dept && d.departemen !== dept) return false;
    if(q && !hay.includes(q)) return false;
    return true;
  });
  page = 1;
  renderTable();
}

function renderTable(){
  const tbody = document.querySelector('#tbl tbody');
  tbody.innerHTML = '';
  const start = (page-1)*perPage;
  const pageItems = filtered.slice(start, start+perPage);
  pageItems.forEach((r, idx)=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${r.id}</td>
                    <td>${r.nama}</td>
                    <td>${r.departemen}</td>
                    <td>${r.unit_kerja}</td>
                    <td>${r.jabatan}</td>
                    <td>${r.tanggal_masuk}</td>`;
    tbody.appendChild(tr);
  });
  document.getElementById('total').textContent = filtered.length;
  renderPager();
}

function renderPager(){
  const pager = document.getElementById('pager');
  pager.innerHTML = '';
  const totalPages = Math.max(1, Math.ceil(filtered.length / perPage));
  const createBtn = (label, cb, disabled=false) => {
    const b = document.createElement('button');
    b.textContent = label; b.className='btn';
    if(disabled) b.disabled = true;
    b.onclick = cb;
    return b;
  };
  pager.appendChild(createBtn('« Prev', ()=>{ if(page>1){ page--; renderTable(); } }, page===1));
  // show up to 7 page buttons around current
  const start = Math.max(1, page-3);
  const end = Math.min(totalPages, page+3);
  for(let p=start;p<=end;p++){
    const b = createBtn(p, ()=>{ page=p; renderTable(); }, false);
    if(p===page){ b.style.fontWeight='700'; b.style.borderColor='var(--accent)'; }
    pager.appendChild(b);
  }
  pager.appendChild(createBtn('Next »', ()=>{ if(page<totalPages){ page++; renderTable(); } }, page===totalPages));
}

document.getElementById('search').addEventListener('input', ()=> applyFilters());
document.getElementById('filter-dept').addEventListener('change', ()=> applyFilters());
document.getElementById('per-page').addEventListener('change', ()=> applyFilters());

loadData();
</script>
</body>
</html>
